# A Case Study for Multi-Instance Learning Based on MNIST

This repository contains a set of pipelines loaded into the PyTorch architecture to process and learn to predict the probability of numbers in multi-instance “packets”, with a document that explains the visualization of data structure and predictions.

## Project Overview

Multi-instance learning is gradually being reused for feature learning, classification and prediction of pathology images. This project aims to use digit 0 and 7 freely combined into packets in the MNIST dataset to stimulate lesion areas in pathology images.

## Repository Contents

- **`MIL IMPLEMENTATION.ipynb`**  
  An iPython notebook that performs the complete downstream analysis:
  - Load MNIST and filter out digit 0 and 7 (64*64 size), generate a uniform fraction distribution of 0s and assign it to the training/test set, create the training and test sets using sampling without replacement
  - Visualize the distribution of fraction and one of the constructed bag
  - Defining the model:
      - ResNet18 as a feature extractor, 128-dimensional last fully-connected layer output
      - Mean pooling
      - 3 layer MLP (dropout = 0.5, 1-dimensional final output)
  - Create and train the model, evaluating and visualization

- **`MIL IMPLEMENTATION.pdf`**  
  A three-page powerpoint that briefly describes and explains the visualized data structure generated by the program and the performance of the predicted results.
 
## How to Use

1. **Clone the repository:**
   ```bash
   git clone https://github.com/<your-username>/<your-repo>.git
2. **Install required packages**, for example,
   ```shell
   conda install pytorch torchvision -c pytorch
   conda install -c conda-forge matplotlib
   # Add other packages as needed
3. **Set random seed**
   ```python
   random.seed(42) # any
   np.random.seed(42) # random
   torch.manual_seed(42) # number
4. **Run the analysis in your IDE:**
The .ipynb will execute and generate visualizations, predictive states and results by cell.

## References

- **Dataset: [MNIST](https://www.mnist.org/)**
- **Tools: [PyTorch](https://pytorch.org/), etc (see `MIL IMPLEMENTATION.ipynb` requirements for details).

## License

This project is open for academic and educational purposes. Please cite the original MNIST dataset if you use this analysis in your work.
